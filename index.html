<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Precision Tool to Customize Lesson Sequence</title>
<link rel="stylesheet" href="styles.css">
<script src="jspdf.umd.min.js"></script>
</head>
<body>
<div class="wrap">
  <div class="header">
    <div class="header-content">
      <h1>Precision Tool to Customize Lesson Sequence</h1>
      <p class="tagline">Use this tool to generate an alternative Family Spirit lesson sequence <span class="break-desktop"></span>tailored to participant and program characteristics.</p>
    </div>
    <img src="Family Spirit Logo.png" alt="Family Spirit Logo" class="logo">
  </div>

  <!-- Planning Information -->
  <div class="card">
    <div class="section-title">Affiliate Scheduling Information</div>
    <div class="grid">
      <label for="pid">Participant ID:</label>
      <input id="pid" type="text" placeholder="(optional)">

      <label for="firstLesson">Date of first lesson:</label>
      <input id="firstLesson" type="date" required>

      <label for="scheduleDuration">Duration of schedule:</label>
      <select id="scheduleDuration">
        <option value="up_to_3rd_birthday" selected>Up to youngest child's 3rd birthday</option>
        <option value="up_to_due_date">Up to due date</option>
        <option value="6_months">6 months from first visit</option>
        <option value="12_months">12 months from first visit</option>
      </select>

      <label for="pacing">Pacing:</label>
      <select id="pacing">
        <option value="standard" selected>Standard</option>
        <option value="defined">Defined</option>
      </select>

      <label for="definedPref">If defined pacing, preference:</label>
      <select id="definedPref" disabled>
        <option value="">— select —</option>
        <option value="weekly">Weekly</option>
        <option value="biweekly">Every 2 weeks</option>
        <option value="monthly">Monthly</option>
        <option value="bimonthly">Every 2 months</option>
      </select>

      <label for="completedLessons">Lessons to exclude from schedule:</label>
      <div class="input-stack">
        <select id="completedLessons" multiple size="8"></select>
        <div class="muted">Hold Ctrl (Windows) or Command (macOS) to select multiple lessons.</div>
        <div class="muted">Selecting one or more of these lessons will remove them from any schedule of visits.</div>
      </div>
    </div>
  </div>

  <!-- Child Information -->
  <div class="card">
    <div class="section-title">Child Information</div>
    <div class="grid">
      <label for="birthDate">Birth or due date of youngest child:</label>
      <input id="birthDate" type="date">
    </div>
  </div>

  <!-- Participant Information -->
  <div class="card">
    <div class="section-title">Participant (Primary Adult) Information</div>
    <div class="grid">
      <label for="ftp">Is the participant a first-time parent?</label>
      <select id="ftp">
        <option value="no">No</option>
        <option value="yes">Yes</option>
      </select>

      <label for="pregnant">Is the participant pregnant?</label>
      <select id="pregnant">
        <option value="no">No</option>
        <option value="yes">Yes</option>
      </select>
    </div>
  </div>

  <!-- Topics -->
  <div class="card">
    <div class="section-title">Topics of Interest to Family (Optional)</div>
    <div class="checkboxes">
      <label><input type="checkbox" id="topic_cfw"> Caregiver &amp; Family Wellbeing</label>
      <label><input type="checkbox" id="topic_fp"> Family Planning</label>
      <label><input type="checkbox" id="topic_nutrition"> Nutrition</label>
      <label><input type="checkbox" id="topic_sti"> Sexually Transmitted Infections</label>
      <label><input type="checkbox" id="topic_substance"> Substance Use</label>
    </div>

  </div>

  <div class="card">
    <div class="section-title">Schedule Actions</div>
    <p class="muted scheduling-note">Visits are always scheduled to comply with the pacing selected in the form. However, visits may not have assigned lessons for one of three reasons: (1) the visit is scheduled during Thanksgiving week, (2) the visit is scheduled during the last two weeks of December, or (3) there are more visits than lessons; these visits are labeled "excess capacity" in the schedule. The default is to always include one lesson per visit; lessons may be doubled-up to ensure that all eligible lessons for a participant are scheduled.</p>
    <div class="btns">
      <button class="primary" id="generateBtn">Generate Schedule</button>
      <button id="resetBtn" type="button">Reset Form</button>
    </div>
    <div id="status" class="muted status-message"></div>
  </div>

  <!-- Download & Use Instructions -->
  <div class="card" id="instructionsCard" style="display:none;">
    <div class="section-title">Download &amp; Use Instructions</div>
    <p class="muted instructions-note">When generating this schedule:<br>
• Lessons are scheduled as close to the standard sequence age as possible, with a grace period of ±4 months. The variance between the child's age at time of delivery and the standard sequence is noted below.<br>
• Any optional topic of interest to the family, when selected, will be scheduled regardless of standard sequence age to ensure the lessons are included in the visit schedule.<br>
• Visits are scheduled to default to one lesson per visit, when possible.</p>
    <p class="muted instructions-note"><strong>Disclaimer:</strong> This schedule has been generated based on the information you provided and the parameters you selected above. The schedule generated is based on pre-defined criteria and does not necessarily align with participant needs, actual schedules, or changes in family dynamics. It is the responsibility of the home visitor to review the drafted schedule and ensure it meets participant needs, including updating the schedule as appropriate or needed.</p>
    <div class="btns">
      <button id="exportPdfBtn" disabled>Download PDF</button>
      <button id="exportTextBtn" disabled>Download Text File</button>
      <button id="exportBtn" disabled>Download CSV</button>
      <button id="exportZipBtn" disabled>Download All Files (Zip)</button>
    </div>
  </div>

  <!-- Results -->
  <div class="card" id="resultsCard" style="display:none;">
    <div class="section-title">Generated Schedule</div>
    <div style="max-height:60vh; overflow:auto; border:1px solid var(--line); border-radius:10px;">
      <table id="scheduleTable">
        <thead>
          <tr>
            <th>Visit #</th>
            <th>Visit Date</th>
            <th>Child Age (months)</th>
            <th>Variance from Standard Sequence</th>
            <th>Lesson Code</th>
            <th>Lesson Subject</th>
            <th>Minutes</th>
            <th>Total per Visit</th>
          </tr>
        </thead>
        <tbody id="scheduleBody"></tbody>
      </table>
    </div>
    <div class="schedule-footer">
      <div id="summary"></div>
      <button id="logBtn" type="button" disabled>View Scheduling Log</button>
    </div>
  </div>

</div>

<script type="module" src="js/app.js"></script>
</body>
</html>
